{% extends "base.html" %}

{% block content %}
<div class="max-w-3xl mx-auto px-4 py-8">
    <div class="relative mb-[-75px]">
        {% if user.header_path %}
            <img src="{{ url_for('uploaded_file', filename=user.header_path) }}" alt="ヘッダー画像" class="w-full h-48 object-cover rounded-t-lg shadow-md">
        {% else %}
            <div class="w-full h-48 bg-gradient-to-r from-kawaii-pink to-kawaii-purple rounded-t-lg"></div>
        {% endif %}
    </div>

    <div class="bg-white/95 backdrop-blur-lg rounded-lg shadow-xl p-8 border border-kawaii-lavender relative">
        <div class="absolute left-1/2 transform -translate-x-1/2 -top-20">
            {% if user.icon_path %}
                <img src="{{ url_for('uploaded_file', filename=user.icon_path) }}" alt="アイコン" class="w-32 h-32 rounded-full border-4 border-white shadow-lg object-cover border border-gray-200">
            {% else %}
                <div class="w-32 h-32 rounded-full bg-gray-300 border-4 border-white shadow-lg flex items-center justify-center border border-gray-200">
                    <span class="text-gray-500 text-3xl">👤</span>
                </div>
            {% endif %}
        </div>

        <div class="text-center mt-16 mb-8">
            <h2 class="text-3xl font-bold text-kawaii-dark">{{ user.name }}</h2>
            <p class="text-md text-kawaii-purple">{{ user.student_id }}</p>
        </div>

        <div class="mb-8 p-4 bg-gray-50 rounded-lg">
            <h3 class="font-bold text-kawaii-dark mb-2">自己紹介</h3>
            <p class="text-gray-700 whitespace-pre-wrap">{{ user.introduction or '自己紹介が設定されていません。' }}</p>
        </div>

        <div class="mb-8">
            <h3 class="font-bold text-kawaii-dark mb-2">タグ</h3>
            <div class="flex flex-wrap gap-2">
                {% if user.tags %}
                    {% for tag in user.tags.split(',') %}
                        {% if tag.strip() %}
                            <span class="bg-kawaii-purple/20 text-kawaii-purple text-sm font-medium px-3 py-1 rounded-full">{{ tag.strip() }}</span>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <p class="text-sm text-gray-500">タグが設定されていません。</p>
                {% endif %}
            </div>
        </div>

        <div class="border-t border-kawaii-lavender/50 pt-6 space-y-4">
            <p><span class="font-semibold text-kawaii-purple">校舎:</span> {{ user.school.school_name }}</p>
            <p><span class="font-semibold text-kawaii-purple">学科:</span> {{ user.department.department_name if user.department else 'なし' }}</p>
            <p><span class="font-semibold text-kawaii-purple">学年:</span> {{ user.year }}年</p>
        </div>
        
        <div class="text-center mt-8">
            <a href="{{ url_for('edit_profile') }}" class="inline-block bg-gray-200 text-gray-700 font-bold py-2 px-6 rounded-full hover:bg-gray-300 transition-colors">
                プロフィールを編集
            </a>
        </div>
    </div>
</div>
{% endblock %}